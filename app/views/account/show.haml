%h1 Cars

%ul.list-group{"ng-init" => "setCars(#{@cars.to_json.html_safe})"}
  -if @cars.empty?
    %li.list-group-item
      .row
        .col-md-2 Car not listed?
        .col-md-8
        .col-md-2
          %a{"ng-click" => "fetch()"} Refetch Car list
  %li.list-group-item{"ng-repeat" => "car in cars"}
    .row
      .col-md-2
        %img.img-thumbnail{src: "http://placehold.it/100/100"}
      .col-md-9
        .col-md-1
          %b Name:
        .col-md-2 {{ car.display_name }}
        %br
        .col-md-1
          %b Year:
        .col-md-2 {{ car.year }}
        %br
        .col-md-1
          %b Make:
        .col-md-2 {{ car.make }}
        %br
        .col-md-1
          %b Model:
        .col-md-2 {{ car.display_model }}, {{ car.submodel }}
        %br
      .col-md-1
        %i.glyphicon.glyphicon-plus{style: "height: 50px; margin-top: 50px;", "ng-click" => "loadTrips(car)"}
      .col-md-4
      .col-md-8{"ng-if" => "car.trips"}
        %table.table
          %thead
            %tr
              %th Start
              %th End
              %th Distance (m)
              %th
          %tbody
            %tr{"ng-repeat" => "trip in car.trips"}
              %td {{ trip.started_at | date:'medium' }}
              %td {{ trip.ended_at | date:'medium' }}
              %td {{ trip.distance_m | number }}m
              %td
                %button.btn.btn-default{"ng-click" => "showMap(trip)"} Show Map

.panel.panel-default{"ng-if" => "fetchedCars"}
  .panel-heading
    %h3 Add A Car!
  .panel-body
    .btn-group.btn-group-justified
      .btn-group{"ng-repeat" => "possibleCar in fetchedCars"}
        .btn.btn-default{"ng-click" => "setCar(possibleCar)", "ng-class" => "isSelected(possibleCar) ? 'active' : ''"} {{ possibleCar.display_name }}
    %form{"ng-submit" => "save(car)", name: "form"}
      %div{"ng-if" => "!saving"}
      %button.btn.btn-default save
    %pre {{ car | json }}